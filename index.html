<!DOCTYPE html>
<html lang="ko-KR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="./images/favicon.ico" type="image/x-icon" />
    <title>1만 시간의 법칙</title>

    <link rel="stylesheet" href="./styles/reset.css" />
    <link rel="stylesheet" href="./styles/style.css" />
    <link
      rel="stylesheet"
      href="./styles/style-mobile.css"
      media="(max-width: 768px)"
    />
  </head>
  <body>
    <div class="container">
      <header class="header">
        <h1 class="header__logo">
          <img
            class="header__img"
            src="./images/title@0.5x.png"
            srcset="
              ./images/title@0.5x.png  480w,
              ./images/title@1x.png    700w,
              ./images/title@2x.png   1000w
            "
            sizes="(max-width: 500px) 444px,
            (max-width: 800px) 777px,
            1222px"
            alt="1만 시간의 법칙"
          />
        </h1>
        <q class="header__desc">
          “연습은 어제의 당신보다 당신을 더 낫게 만든다.”
        </q>
      </header>

      <main class="main">
        <section class="cont">
          <h2 class="a11y-hidden">1만 시간의 법칙이란?</h2>
          <div class="cont__desc">
            <p class="cont__text">
              <dfn>1만 시간의 법칙</dfn>은<br />
              어떤 분야의 전문가가 되기 위해서는<br />
              최소한 <time datetime="10000h">1만 시간</time>의 훈련이 필요하다는
              법칙이다.
            </p>
          </div>

          <h3 class="a11y-hidden">나의 1만 시간 법칙 찾기</h3>
          <form class="form" id="get_time_form">
            <p class="form__text">
              나는
              <label for="skill" class="a11y-hidden">전문 분야</label>
              <input
                class="form__input"
                type="text"
                name="skill"
                id="skill"
                placeholder="예)프로그래밍"
                required
              />
              전문가가 될 것이다.
            </p>
            <p class="form__text">
              <span class="form__text--mobile">그래서 앞으로 매일 하루에</span>
              <label for="hour" class="a11y-hidden">훈련 시간</label>
              <input
                class="form__input"
                type="number"
                min="1"
                max="24"
                name="hour"
                id="hour"
                placeholder="예)5시간"
                required
              />
              시간씩 훈련할 것이다.
            </p>

            <button class="form__btn">
              나는 며칠 동안 훈련을 해야
              <span class="form__btn--mobile">1만 시간이 될까?</span>
            </button>
          </form>
        </section>

        <section class="result">
          <h2 class="a11y-hidden">나의 1만 시간 법칙 결과</h2>
          <div class="result__cont">
            <p class="result__text">
              당신은
              <strong
                ><output id="result_skill" name="result_skill" for="skill"
                  >프로그래밍</output
                ></strong
              >
              전문가가 되기 위해서
            </p>
            <p class="result__text">
              대략
              <strong
                ><output id="result_hour" name="result_hour" for="hour"
                  >5110</output
                ></strong
              >
              일 이상 훈련하셔야 합니다! :)
            </p>
          </div>

          <div class="result__btns">
            <button id="open_modal_btn" class="result__btn">
              훈련하러 가기 GO! GO!
            </button>
            <button class="result__btn result__btn--white">공유하기</button>
          </div>
        </section>
      </main>

      <footer class="footer">
        <h2 class="a11y-hidden">위니브 저작권 안내</h2>
        <h3 class="logo">
          <img class="logo__img" src="./images/logo-m.svg" alt="weniv" />
        </h3>
        <p class="footer__copyright">
          본 서비스 내 이미지 및 콘텐츠의 저작권은 주식회사 위니브에
          있습니다.<br />
          수정 및 재배포, 무단 도용 시 법적인 문제가 발생할 수 있습니다.
        </p>
      </footer>
    </div>

    <div id="modal" class="modal__wrap">
      <section class="modal">
        <h2 class="a11y-hidden">훈련하러 가기 모달</h2>
        <p class="modal__text modal__text--large">
          화이팅!!<span class="modal__text--mobile">♥♥♥</span>
        </p>
        <p class="modal__text modal__text--small">당신의 꿈을 응원합니다!</p>

        <img
          class="modal__img"
          src="./images/licat@0.5x.png"
          srcset="
            ./images/licat@0.5x.png  480w,
            ./images/licat@1x.png    700w,
            ./images/licat@2x.png   1000w
          "
          sizes="(max-width: 500px) 444px,
            (max-width: 800px) 777px,
            1222px"
          alt="응원하는 라이캣"
        />

        <button id="close_modal_btn" class="modal__btn" type="button">
          <span class="modal__btn--mobile"> 종료하고 진짜</span>
          훈련하러 가기 GO!GO!
        </button>
      </section>
    </div>

    <script>
      // 포커스 트랩 제거 함수 저장 변수
      let removeTrap = null;
      // 포커스 트랩 기능 -chatGPT 도움
      function trapFocus(element) {
        // 메뉴 안에서 포커스 가능한 모든 요소
        const focusableEls = element.querySelectorAll("a[href], button");

        const firstFocusable = focusableEls[0]; // 첫번째 요소
        const lastFocusable = focusableEls[focusableEls.length - 1]; // 마지막 요소

        // 키보드 이벤트
        function handleKeyDown(e) {
          if (e.key === "Tab") {
            if (e.shiftKey) {
              // Shift + Tab
              // 첫번째 요소이면 제일 마지막 요소에 포커스
              if (document.activeElement === firstFocusable) {
                e.preventDefault(); // 기본 동작 막기
                lastFocusable.focus();
              }
            } else {
              // Tab
              // 마지막 요소이면 제일 첫번째 요소에 포커스
              if (document.activeElement === lastFocusable) {
                e.preventDefault();
                firstFocusable.focus();
              }
            }
          } else if (e.key === "Escape") {
            // ESC 키로 메뉴 닫기
            closeNav();
          }
        }

        // 요소에 이벤트 추가
        element.addEventListener("keydown", handleKeyDown);

        // 메뉴 닫힐 때 이벤트 제거
        return () => {
          element.removeEventListener("keydown", handleKeyDown);
        };
      }

      const open_modal_btn = document.querySelector("#open_modal_btn");
      const modal = document.querySelector("#modal");
      const close_modal_btn = document.querySelector("#close_modal_btn");

      open_modal_btn.addEventListener("click", () => {
        modal.classList.add("modal-show");

        open_modal_btn.setAttribute("aria-expanded", "true"); // ARIA 상태 업데이트
        removeTrap = trapFocus(modal); // 포커스 트랩 활성화

        // 첫 포커스 이동
        const firstLink = modal.querySelector("a, button");
        firstLink.focus();
      });
      close_modal_btn.addEventListener("click", () => {
        modal.classList.remove("modal-show");

        close_modal_btn.setAttribute("aria-expanded", "false");
        if (removeTrap) removeTrap(); // 포커스 트랩 이벤트 제거
        close_modal_btn.focus(); // 다시 열기 버튼에 포커스
      });

      const get_time_form = document.querySelector("#get_time_form");
      get_time_form.addEventListener("submit", (event) => {
        if (!get_time_form.checkValidity()) {
          // 기본 메시지 보여주기
          return; // 여기서 그냥 종료 → 제출 안 함
        }

        // 기본 동작 막기 (전송 방지)
        event.preventDefault();

        const standard = 10000; // 기준시간

        // 입력 값
        const skill = get_time_form.querySelector("#skill").value;
        const hour = get_time_form.querySelector("#hour").value;

        // 출력 값
        const result_skill = document.querySelector("#result_skill");
        const result_hour = document.querySelector("#result_hour");

        result_skill.innerText = skill;
        result_hour.innerText = Math.floor(standard / hour); // 이상이니 내림으로 계산
      });
    </script>
  </body>
</html>
